!function(e,t,i,n){"use strict";var a=function(){var e=i.body||i.documentElement;return e=e.style,""===e.WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition?"":!1},r=a()===!1?!1:!0,o=function(e,t,i){var n={},r=a();n[r+"transform"]="translateX("+t+")",n[r+"transition"]=r+"transform "+i+"s linear",e.css(n)},g="ontouchstart"in t,s=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,d=function(e){if(g)return!0;if(!s||"undefined"==typeof e||"undefined"==typeof e.pointerType)return!1;if("undefined"!=typeof e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!=e.pointerType)return!0}else if("mouse"!=e.pointerType)return!0;return!1};e.fn.imageLightbox=function(n){return n=e.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:!0,enableKeyboard:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,onStart:!1,onEnd:!1,onLoadStart:!1,onLoadEnd:!1},n),targets=e([]),target=e(),image=e(),imageWidth=0,imageHeight=0,swipeDiff=0,inProgress=!1,isTargetValid=function(t){return"a"==e(t).prop("tagName").toLowerCase()&&new RegExp(".("+n.allowedTypes+")$","i").test(e(t).attr("href"))},setImage=function(){if(!image.length)return!0;var i=.8*e(t).width(),n=.9*e(t).height(),a=new Image;a.src=image.attr("src"),a.onload=function(){if(imageWidth=a.width,imageHeight=a.height,imageWidth>i||imageHeight>n){var r=imageWidth/imageHeight>i/n?imageWidth/i:imageHeight/n;imageWidth/=r,imageHeight/=r}image.css({width:imageWidth+"px",height:imageHeight+"px",top:(e(t).height()-imageHeight)/2+"px",left:(e(t).width()-imageWidth)/2+"px"})}},loadImage=function(t){if(inProgress)return!1;if(t="undefined"==typeof t?!1:"left"==t?1:-1,image.length){if(t!==!1&&(targets.length<2||n.quitOnEnd===!0&&(-1===t&&0===targets.index(target)||1===t&&targets.index(target)==targets.length-1)))return quitLightbox(),!1;var i={opacity:0};r?o(image,100*t-swipeDiff+"px",n.animationSpeed/1e3):i.left=parseInt(image.css("left"))+100*t+"px",image.animate(i,n.animationSpeed,function(){removeImage()}),swipeDiff=0}inProgress=!0,n.onLoadStart!==!1&&n.onLoadStart(),setTimeout(function(){image=e("<img "+n.selector+" />").attr("src",target.attr("href")).load(function(){image.appendTo("body"),setImage();var i={opacity:1};if(image.css("opacity",0),r)o(image,-100*t+"px",0),setTimeout(function(){o(image,"0px",n.animationSpeed/1e3)},50);else{var a=parseInt(image.css("left"));i.left=a+"px",image.css("left",a-100*t+"px")}if(image.animate(i,n.animationSpeed,function(){inProgress=!1,n.onLoadEnd!==!1&&n.onLoadEnd()}),n.preloadNext){var g=targets.eq(targets.index(target)+1);g.length||(g=targets.eq(0)),e("<img />").attr("src",g.attr("href")).load()}}).error(function(){n.onLoadEnd!==!1&&n.onLoadEnd()});var i=0,a=0,g=0;image.on(s?"pointerup MSPointerUp":"click",function(e){if(e.preventDefault(),n.quitOnImgClick)return quitLightbox(),!1;if(d(e.originalEvent))return!0;var t=(e.pageX||e.originalEvent.pageX)-e.target.offsetLeft;target=targets.eq(targets.index(target)-(imageWidth/2>t?1:-1)),target.length||(target=targets.eq(imageWidth/2>t?targets.length:0)),loadImage(imageWidth/2>t?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(e){return!d(e.originalEvent)||n.quitOnImgClick?!0:(r&&(g=parseInt(image.css("left"))),void(i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX))}).on("touchmove pointermove MSPointerMove",function(e){return!d(e.originalEvent)||n.quitOnImgClick?!0:(e.preventDefault(),a=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,swipeDiff=i-a,void(r?o(image,-swipeDiff+"px",0):image.css("left",g-swipeDiff+"px")))}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(e){return!d(e.originalEvent)||n.quitOnImgClick?!0:void(Math.abs(swipeDiff)>50?(target=targets.eq(targets.index(target)-(swipeDiff<0?1:-1)),target.length||(target=targets.eq(swipeDiff<0?targets.length:0)),loadImage(swipeDiff>0?"right":"left")):r?o(image,"0px",n.animationSpeed/1e3):image.animate({left:g+"px"},n.animationSpeed/2))})},n.animationSpeed+100)},removeImage=function(){return image.length?(image.remove(),void(image=e())):!1},quitLightbox=function(){return image.length?void image.animate({opacity:0},n.animationSpeed,function(){removeImage(),inProgress=!1,n.onEnd!==!1&&n.onEnd()}):!1},e(t).on("resize",setImage),n.quitOnDocClick&&e(i).on(g?"touchend":"click",function(t){image.length&&!e(t.target).is(image)&&quitLightbox()}),n.enableKeyboard&&e(i).on("keyup",function(e){return image.length?(e.preventDefault(),27==e.keyCode&&quitLightbox(),void((37==e.keyCode||39==e.keyCode)&&(target=targets.eq(targets.index(target)-(37==e.keyCode?1:-1)),target.length||(target=targets.eq(37==e.keyCode?targets.length:0)),loadImage(37==e.keyCode?"left":"right")))):!0}),e(i).on("click",this.selector,function(t){return isTargetValid(this)?(t.preventDefault(),inProgress?!1:(inProgress=!1,n.onStart!==!1&&n.onStart(),target=e(this),void loadImage())):!0}),this.each(function(){return isTargetValid(this)?void(targets=targets.add(e(this))):!0}),this.switchImageLightbox=function(e){var t=targets.eq(e);if(t.length){var i=targets.index(target);target=t,loadImage(i>e?"left":"right")}return this},this.quitImageLightbox=function(){return quitLightbox(),this},this}}(jQuery,window,document);