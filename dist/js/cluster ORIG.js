var cluster={shellac:function(t,e){function i(e){if(t.currentStyle)var i=t.currentStyle[e];else if(window.getComputedStyle)var i=document.defaultView.getComputedStyle(t,null).getPropertyValue(e);return i}null==e&&(e=new Object,e.font=i("font-family"),e.weight=i("font-weight"),e.size=parseInt(i("font-size")),e.style=i("font-style"),e.color=i("color"),e.leading=parseInt(i("line-height")));var r=document.createElement("canvas");r.setAttribute("class","shellac"),r.width=t.clientWidth,r.height=t.clientHeight,t.parentNode.insertBefore(r,t.nextSibling),context=r.getContext("2d"),context.fillStyle=e.color,context.font=e.weight+" "+e.style+" "+e.size+"px "+e.font;for(var a=t.innerHTML,n=a.split(" "),s=new Array,o="",l=0;l<n.length;l++){var h=n[l],c=context.measureText(o+" "+h).width;0==l?o=h:c<t.clientWidth?o+=" "+h:(s.push(o),o=h)}s.push(o);for(var l=0;l<s.length;l++)context.fillText(s[l],0,l*e.leading+e.size);return r},getTypeData:function(t){this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight;var e=this.canvas.getContext("2d");return imageData=e.getImageData(0,0,this.width,this.height),p=this.canvas.parentNode,p.removeChild(this.canvas),imageData},generateShapes:function(){for(var t=[],e=0;e<this.height;e+=this.density)for(var i=0;i<this.width;i+=this.density){var r=this.imageData.data[4*(i+e*this.width)-1];r>0&&(t[i*e]=new this.Node(i,e,this))}return t},Node:function(t,e,i){var r=this,a=i.radius;r.el=document.createElementNS("http://www.w3.org/2000/svg",i.shape),r.el.setAttribute("opacity",0);var n=parseInt(Math.random()*i.speed);r.el.setAttribute("cx",0),r.el.setAttribute("cx",t),r.el.setAttribute("cy",e+100),r.el.setAttribute("r",i.radius),r.el.setAttribute("fill",i.colors[parseInt(4*Math.random())]);{var s=function(){a+=1,i.root.suspendRedraw(100),r.el.setAttribute("opacity",a),i.root.unsuspendRedrawAll()};window.setTimeout(s,n)}return i.root.appendChild(r.el),r.grow=function(t,e){e.target.Y=0;var i=t.radius,r=this;this.loop=function(){t.root.suspendRedraw(100),e.target.Y=e.target.Y-6,e.target.setAttribute("transform","translate(0,"+e.target.Y+")"),i+=.1,e.target.setAttribute("r",i),e.target.setAttribute("opacity",.7),t.root.unsuspendRedrawAll(),e.target.Y<t.timeout&&clearInterval(r.timer)},r.timer=window.setInterval(this.loop,40)},this.el.addEventListener("mouseover",function(t){r.grow(i,t)},!0),r.el.x=t,r.el.y=e,this},init:function(t){var e=this,t=document.getElementById(t);t.className+=" clustered",e.root=document.createElementNS("http://www.w3.org/2000/svg","svg"),e.root.setAttribute("width",t.clientWidth),e.root.setAttribute("height",t.clientHeight),e.root.setAttribute("id","clustered");var i=function(){e.canvas=e.shellac(t),e.imageData=e.getTypeData(t);e.generateShapes();t.appendChild(e.root),t.className+=" active"};window.setTimeout(i,100)},root:null,nodes:[],density:14,radius:12,target:"cluster",shape:"circle",speed:1e3,timeout:-700,colors:[]};cluster.init("to_cluster");