function loadAPIClientInterfaces(){gapi.client.load("youtube","v3",function(){handleAPILoaded()})}function handleAPILoaded(){requestUserUploadsPlaylistId()}function requestUserUploadsPlaylistId(){var e=gapi.client.youtube.channels.list({forUsername:"ucdtramp",part:"contentDetails"});e.execute(function(e){playlistId=e.result.items[0].contentDetails.relatedPlaylists.uploads,requestVideoPlaylist(playlistId)})}function requestVideoPlaylist(e,t){var a={playlistId:e,part:"snippet",fields:"items/snippet(publishedAt,thumbnails/high,title,resourceId/videoId),nextPageToken",maxResults:50};t&&(a.pageToken=t);var i=gapi.client.youtube.playlistItems.list(a);i.execute(function(t){var a=t.result.items;$.each(a,function(e,t){videoSnippet=t.snippet;var a=/((?:\d{2}){1,2})/gim,i=a.exec(videoSnippet.title);videoSnippet.ucdtrampYear="no year",i&&(videoSnippet.ucdtrampYear=2==i[1].length?"20"+i[1]:i[1]),name=videoSnippet.title.replace(/[0-9]/gim,""),videoSnippet.ucdtrampComp="no comp";for(var n in competitions){var r=new RegExp("("+competitions[n]+")","igm"),o=r.exec(name);if(o){videoSnippet.ucdtrampComp=o[1],name=name.replace(o[1],"");break}}for(var s in levelsEtc)regex=new RegExp(levelsEtc[s],"igm"),name=name.replace(regex,"");videoSnippet.ucdtrampName=name.trim(),name.search(/synchro/gim)>-1&&(videoSnippet.ucdtrampName="Synchro");for(s in handPickedRandomShit)regex=new RegExp(handPickedRandomShit[s],"i"),videoSnippet.ucdtrampName.search(regex)>-1&&(videoSnippet.ucdtrampName="Msc",videoSnippet.ucdtrampYear="Year is not important");("no year"==videoSnippet.ucdtrampYear||"no comp"==videoSnippet.ucdtrampComp||""===videoSnippet.ucdtrampName)&&(videoSnippet.ucdtrampName="Msc",videoSnippet.ucdtrampYear="Year is not important"),allPlaylistItems.push(videoSnippet),allUcdtrampNames.push(videoSnippet.ucdtrampName)}),nextPageToken=t.result.nextPageToken,nextPageToken?($status.html(allPlaylistItems.length+" videos fetched so far..."),requestVideoPlaylist(e,nextPageToken)):($status.html(allPlaylistItems.length+" videos fetched in total"),$status.append("<br><strong>Finished</strong><br>Saving..."),handleVideoPlaylist())})}function saveJson(e){e=JSON.stringify(e),$.ajax({type:"POST",url:"youtubevids.php",data:"action=saveJson&json="+e,dataType:"text",success:function(e){$status.append(""===e?'<strong style="color:green">New JSON has been saved!</strong>':'<strong style="color:red">Something went wrong! Tell the webmaster</strong><br>'+e)}})}var apiKey="AIzaSyB4__3jfqqrcViXDrpcmSfr5JkX_ObL6bY";googleApiClientReady=function(){gapi.client.setApiKey(apiKey),loadAPIClientInterfaces()};var arrayUnique=function(e){return e.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])},$contianer=$(".html-container"),$status=$(".status"),playlistId,nextPageToken,prevPageToken,allPlaylistItems=[],allUcdtrampNames=[],competitions=["in house","in-house","intervarsities","ssto","isto","colours","dubl?in open","scotland","inters","national finals","nationals","Athy Regionals","UCD Regionals","athy","regionals","qualifiers","UCLan"],levelsEtc=["set","vol","routine","Two-Trick","dmt","Tumbling","pro","mens?","ladies","Novice","Intermediate","Intervanced","Advanced","Elite","gold","silver","bronze","[,-:.()]"],handPickedRandomShit=["Chair Sex","Group Hug","Clare d man Beater","Gnomes","March","D Speach","Hairdressing","Hallway Antics","Pantless Ryan","Fuck d Dealer","Rosie and Fiona Swing Dancing","Sisters","Suck on a Lemon","Trampolining at","Street Singin"];handleVideoPlaylist=function(){allUcdtrampNames=arrayUnique(allUcdtrampNames).sort();var e={},t="";for(var a in allUcdtrampNames){var i=allUcdtrampNames[a];if("function"!=typeof i){e[i]=[];for(var n in allPlaylistItems){var r=allPlaylistItems[n];r.ucdtrampName==i&&e[i].push({year:r.ucdtrampYear,comp:r.ucdtrampComp,title:r.title,urlId:r.resourceId.videoId,thumb:r.thumbnails.high.url})}}}console.log(e),saveJson(e);for(a in allUcdtrampNames){var i=allUcdtrampNames[a];t+="<h3>"+i+"</h3>";for(n in allPlaylistItems){var r=allPlaylistItems[n];r.ucdtrampName==i&&(t+="Year: "+r.ucdtrampYear+" - Competition: "+r.ucdtrampComp+' - Video: <a target="_blank" href="https://www.youtube.com/edit?o=U&video_id='+r.resourceId.videoId+'">'+r.title+"</a> <br>")}}$contianer.append(t)};